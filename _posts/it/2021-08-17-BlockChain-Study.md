---
title: "BlockChain 학습하기"
date: 2021-08-17 17:37:28 -0400
categories: blockchain
---

# 블럭체인이란

참고
[블럭체인 활성화 방안](http://www.lgchallengers.com/wp-content/uploads/global/global_pdf/2016_M0529.pdf)
[블럭체인기술정의](https://brownbears.tistory.com/371?category=281929)

## 블럭체인 등장 배경
블록체인은 2013년 뉴욕타임즈, 옥스포드사전 선정 ‘올해의 단어’로도 선정되었던 비트코인과 함께 등장했다.

비트코인은 2008년 10월 사토시 나카모토(Satoshi Nakamoto)에 의해 발 표 된 한 편 의 논 문 (Bitcoin: A Peer-to-Peer Electronic Cash system)으로 시작되어 2009년 1월부터 일반화폐와 다르게 중앙은행과 같은 중개기관없이 P2P방식으로 사용자(node)간에 자유롭게 거래하는 온라인 가상화폐이다.

이러한 '비트코인'이라는 전자화폐를 안전하게 저장하고 사용하기 위하여 고안된 보안 기술이 바로 블록체인 기술이다. 블록체인은 공공 거래 장부라고도 부르며, 금융거래 시 발생할 수 있는 이중 지불 방지 및 위 변조가 불가능한 기술로 국내에서는 핀테크의 핵심 기술로 자리 잡았다.

## 블럭체인이란
블록체인은 공공 거래 장부, 분산 장부(Distributed Ledger)라고 불린다. “ 즉, 네트워크 내의 모든 참여자가 공동으로 거래 정보를 검증, 기록, 보관함으로써 은행과 같은 ‘공인된 제 3자’ 없이도 거래 기록의 신뢰성을 확보하는 기술이다.

**기존 중앙은행 방식**
예를 들어 A씨가 은행에 가서 “내가 맡겨둔 돈 100만원을 돌려달라”라고 한다고 가정하자. 그렇다면 은행 직원은 먼저 거래 장부에 A씨가 100만원을 맡긴 기록이 있는지 먼저 확인할 것이다. 만약 은행이 100만원을 받은 기록이 있다면 A씨는 돈을 받을 수 있을 것이다. 이렇듯 거래 장부는 금융 거래를 성사시키는 중요한 요소다.

데이터 조작 : 중앙은행의 거래 장부 조작으로 100만워 -> 1억 변경
데이터 조작 방지를 위해서 서버 접근 통제 및 각종 보안 프로그램광 장비, 24시가 경비

**블럭체인 방식**
블록체인은 중요한 정보를 꽁꽁 싸매고 숨겨야 한다는 보안의 상식을 뒤엎었다. 오히려 모든 사람이 정보를 공유함으로써 데이터를 조작하지 못하게 막는 방법을 고안했다. 데이터를 공유하는 사람이 많아질 수록 안정성이 더 커진다. 이게 바로 비트코인 블록체인이다.

<img width="961" alt="image" src="https://user-images.githubusercontent.com/7900446/116539784-47981c80-a924-11eb-99ba-745690e4d2cb.png">

## 블럭체인 기술
블럭체인인 최초의 블럭(Genesis Block)부터 시작해 바로 앞의 블럭에 대한 링크를 가지고 있는 링크드 리스트인 자료구조, 블럭과 블럭을 체인을 이어진 형태.
블럭체인에서 사용되는 블럭은 일정 시간마다 생성됨. 약 10분 => 이러 인해 비트코인은 실시간 거래에 적합하지 않음. 
>커피한잔 마시려고 결재하려며 10분을 기다려야 결재될 수 있음.

### 블럭 구성요소
블럭은 블럭 헤더와 거래정보, 기타 정보로 구성된 블럭 바디로 구성

#### 블럭해시(Block Hash)
블럭 해시는 블럭의 식별자 역할
블럭 해시는 벌럭의 해더 정보인 버젼, 이전 블럭해시, 머클 루트, 타임, bits, 논스를 모두 더한 후 SHA256으로 두번 변환한 결과 값

#### 블럭 체인 구조
<img width="918" alt="image" src="https://user-images.githubusercontent.com/7900446/116542639-d5c1d200-a927-11eb-9038-80d10ea33192.png">


#### 머클 해시
머클해시는 블럭의 바디 부분에 저장된 트랜잭션(거래 정보)들의 해시 트리
각 트랜잭션과 가까운 노드끼리 쌍을 지어 해시 값을 구하고 최종적으로 구해진 해시 값이 머클 해시값임
머클 해시 값을 통해 단일 블럭 내에 존재하는 트랜잭션의 무결성을 검증할 수 있으며 머클해시 값을 이용하여 블럭의 해시 값을 생성하였기 때문에 브럭해시의 무결성도 함께 검증됨
<img width="599" alt="image" src="https://user-images.githubusercontent.com/7900446/116542616-cd699700-a927-11eb-9776-0e7eb4f49ad3.png">



#### nonce
블럭을 만드는 과정에서 해시 값을 구할 때 필요한 재료 역할을 수행함.

완료괸 거래 정보의 변겨이 사살상 불가능한 이유
>거래 정보의 해시값은 해당 거래가 포함된 블럭의 머클 해시 계산에 입력값으로 사용되고, 머클해시는 블럭 해쉬의 계산에 입력값으로 사용됨. 블럭 해시는 다음 블럭(A라하면) previousblockhash 값으로 저장되면, previousblockhash은 A블럭의 블럭 헤더 정보로서, A블럭의 블럭 해쉬를 계산하는데 입력값으로 사용됨. 따라서, 거래 정보가 변경되면 marklehash 가 변경되고, marklehash가 변경되면 블럭 해쉬가 변경되고, 블럭 해쉬의 변경은 다음 블럭의 블럭 해쉬 변경으로 연쇄적으로 이어지게 됨. 그리고 블럭 해쉬는 작업 증명(Proof of Work)의 해답(nonnce 값)을 찾아내야 구할 수 있으므로, 거래 정보를 변경한 블럭부터 그 이후의 모든 블럭을 순서대로 다시 채굴해야 함
>예를 들어, 블럭 하나를 채굴하는데 평균 10분이 소요되고, 현재 총 블럭 수가 약 40만 블럭이라고 할때, 최초의 원조 블럭인 Genesis 블럭에 포함된 거래를 변경하면 약 400만 분, 약 7.6년의 시간이 소요됨. 만약 거래를 변경한다 해도 새로운 블럭들이 평균 10분 마다 하나씩 계속 생성되므로 예상 소요시간은 계속적으로 늘어나기 때문에 이를 모두 뒤집는 것은 사실상 불가능함.
> 즉 완료된 거래 정보를 변경하려면, 변경하려는 거래 정보가 포함된 블럭부터 그 이후의 모든 블럭을 순서대로 다시 채굴해야 하는데, 이는 많은 시간이 소요되고, 그 동안 다른 노드들에 의해 블럭이 계속 추가되므로, 완료된 거래 정보의 변경은 현실적으로 불가능함


### 블럭체인 프로세스
블록체인은 10분마다 모든 사용자들이 모여 거래 장부를 검사한다. 만일 숫자가 잘못 적히거나 거래내역이 누락된 장부가 있으면, 다른 사람이 가진 멀쩡한 장부를 복제해 오류가 있는 부분을 대체한다. 멀쩡한 장부란 전체 비트코인 사용자 가운데 과반수가 갖고 있는 데이터와 일치하는 장부를 가리킨다. 전체 사용자 중 절반 이상(51%)이 인정하면 그 장부를 진짜라고 여긴다는 뜻이다. 과반수의 동의가 거래장부를 공인하는 구조다.

블록체인에서는 10분단위로 발생한 모든 거래 정보가 기록된 거래장부인 '블록(Block)'을 생성한다. 해당 블록을 모든 구성원들에게 전송하고, 전송된 블록의 유효성이 확인 될 경우 기존 블록에 연결하는 방식으로 구현된다. 그리고 10분마다 이 과정을 반복하게 된다.
<img width="1337" alt="image" src="https://user-images.githubusercontent.com/7900446/116544389-060a7000-a92a-11eb-820a-a3be5f643592.png">

**과반수 거래 검증 메커니즘 : 작업 증명 방식(POW; Proof of Work)**
>작업증명이란 거래 유효성 검증 방식으로 많은 컴퓨팅 파워가 필요한 어려운 작업(반복연산 문제 풀기)을 연속해서 수행하도록 함으로써 가장 많은 구성원들이 가지고 있는 블록체인을 진짜로 인식해 다른 기록은 폐기하는 방식이다.
>모든 사용자가 머리를 맞대고 풀면 10분이 걸리는 수학 문제를 주고 답이 맞는지 확인한다. 정답을 찾아냈다면 이를 기록하고 또 10분 동안 새로운 문제를 푼다. 정답을 맞히면 전에 나온 정답 뒤에 새로 풀어낸 답을 이어 붙이고 다음 문제를 푼다. 즉, 10분이 걸리는 수학문제란 블록체인 생성 과정을 달리 말한 것이다.
>따라서 정보를 조작하기 위해서는 전체 참여자의 과반수보다 많은 연산 작업을 시행해야 한다. 그러기 위해서 과반수보다 많은 컴퓨팅 파워(51% Attack)를 보유해야 하나 사실상 불가능에 가깝다. 2013년 말 비트코인 네트워크에 사용자가 기여한 계산 능력은 이미 세계 1위에서 500위까지 슈퍼컴퓨터를 모두 더한 것을 넘어섰다.
>물론 이런 작업을 사용자가 직접 하지 않는다. 인터넷에 연결된 사용자 컴퓨터가 처리한다. 사용자는 블록체인 네트워크 유지에 자기 컴퓨팅 파워를 내준 대가로 소정의 비트코인을 얻을 기회를 얻는다.


### 마이닝(채굴) 과정이란
마이닝 과정은 임의의 숫자를 이용하여 Difficulty Target을 푸는 과정 입니다. Difficulty Target란 해시함수를 풀기 위한 임의로 설정된 숫자 입니다. 이러한 Difficulty Target을 찾기 위해서는 처음부터 끝까지 하나씩 임의의 숫자를 대입하는 brutal force를 활용해서 풀 수 밖에 없습니다. 프로세스가 진행되는 과정에서 Difficulty Target 보다 낮은 숫자가 나오면 마이닝 프로세스가 끝이 나며 특정 컴퓨터가 이 블록을 마이닝 했다는 것을 확인 받습니다.
통상, Difficulty Target을 찾는 시간은 10분 내외이며, 마이닝 완료 시 10분 안에 있었던 컴퓨팅 파워의 모든 프로세스가 모여 하나의 블록을 생성합니다. 따라서 해킹을 위해서는 10분간 마이닝에 이루어지는 컴 퓨팅파워보다훨씬큰컴퓨팅파워를갖고마이닝과정을해독하며이 전 블록과 새로운 블록을 고쳐야 합니다.
하지만 10분 안에 이러한 과정을 처리할 수 있는 컴퓨팅 파워는 존재하지 않습니다. 즉, 앞서 설명한 10분 마다 작업증명(PoW)을 통해 거래 유효성 검증 과정이 일련의 마이닝 과정으로 이해하면 된다. 블록체인 네트워크 입장에서는 p2p 모든 사용자의 컴퓨팅 파워를 이용해 거래의 신뢰성을 획득하고 사용자들은 마이닝 과정에 컴퓨팅 파워를 제공함으로써 비트코인을 인센티브로 제공받는다.

### 블럭체인의 특징
* 탈중개성 : 모든 참여자가 정보 공유함으로써 공인된 제 3자가 불필요
* 보안 및 안정성 : 해킹이 사실상 불가능함.
* 투명성 : 기본적으로 공개성. 모든 참여자들이 장부를 공유하고 있기 때문에 기본적으로 모든 거래기록이 투명하게 공개됨
* 확장성 : 현재 금융권 중심으로 활요되고 있지만 활용도가 무궁무진함.

> 비트코인은 2100만개만 발행이 가능하며 2017년 6월 1,650만개가 발행되었다. 전문가들은 비트코인이 전부 발행되는 시점을 2150년 즈음으로 예상.비트코인은 소수점 8자리까지 나눌 수 있게 설계됐다. 비트코인의 가장 작은 단위는 창안자인 사토시 나카모토를 기념하기 위해 ‘사토시’라는 단위로 불린다.
> 비트코인은 1Block의 사이즈 : 1~4M

### 블럭체인 확장 사례
<img width="1443" alt="image" src="https://user-images.githubusercontent.com/7900446/116544454-1de1f400-a92a-11eb-96af-24777841027f.png">

'스마트계약(smart contract)'
블록체인 플랫폼을 통해 일정 조건을 만족시키면 자동으로 거래가 실행되도록 프로그래밍 하는 것으로 소유권 이전이나 상속·증여 등에 사용될 수 있다. 독일의 스타트업 Slock은 스마트계약을 부동산 임대에 적용했다. 블록체인을 통해 부동산 보증금과 임대료 지불이 확인되면 스마트폰을 이용해 건물에 부착된 스마트자물쇠를 열 수 있게 된다. Slock은 공유경제가 확산되는 추세에서 이 같은 스마트계약 기술의 활용도가 높아질 것으로 전망했다.

다이아몬드 유통 시장 적용
Everledger는 블록체인을 이용하여 다이아몬드의 유통과정을 기록함으로서 다이아몬드의 진위여부를 가리고 불법거래를 방지한다. Everledger의 소프트웨어는 가공된 다이아몬드의 40군데를 측정해 디지털 지문을 만든다. 똑같은 다이아몬드는 없다. 그때부터 블록체인은 해당 다이아몬드의 소유 이전 경로를 기록하고 인증 받는다. 아무도 변경할 수 없다. 따라서 특정 다이아몬드의 합법적인 출처가 밝혀지지 않는다면 ‘블러드 다이아몬드’이거나 장물이라고 의심할 수 있다.

# Python을 이용한 BlockChain 기초 학습
ref :
- https://github.com/JoMingyu/Blockchain-py

repo : https://github.com/TovenBae/blockchain-study.git
